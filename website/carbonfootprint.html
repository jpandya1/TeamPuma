<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Carbon Footprint Tracker</title>
        <link rel="stylesheet" href="./stylesheet.css">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
        <script src="https://cdnjs.com/libraries/Chart.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <style>
        #data_table {
          font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
          border-collapse: collapse;
          width: 100%;
        }

        #data_table td, #data_table th {
          border: 1px solid #ddd;
          padding: 8px;
        }

        #data_table tr:nth-child(even){background-color: #f2f2f2;}

        #data_table tr:hover {background-color: #ddd;}

        #data_table th {
          padding-top: 12px;
          padding-bottom: 12px;
          text-align: left;
          background-color: #4CAF50;
          color: white;
        }
        h1{
            font-family: "Helvetica";
            font-weight: bold;
        }

    </style>
       


    </head>
    <body>

        <div id="navigationBanner">
    		<ul>
    			<li><a href="./splashpage.html">Home</a></li>
    			<li><a href="https://www.google.com/">Contact</a></li>
    			<li><a href="./about.html">About</a></li>
    			<li><a href="./searchpage.html">Search</a></li>
    		</ul>
    	</div>

        <div id="titleBanner">
            <div id="titleBannerImage">
                <img src="images/recycle_image1.png" alt="image0" height="100">
            </div>
            <div id="titleBannerText">
                <h1>Green Routine</h1>
                <h2>Empowering users to recycle responsibly</h2>
            </div>
        </div>

        <h1>Carbon Footprint Calculator</h1>
        <div id="wrapper">
            <table align='center' cellspacing=2 cellpadding=5 id="data_table" border=1>
                <tr>
                    <th>Item</th>
                    <th>Carbon content</th>
                    <th>Category</th>
                    <th>Quantity</th>
                    <th>Total Emission</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>

                <tr id="row1">
                    <td id="name_row1">Coke bottle</td>
                    <td id="country_row1">82.8</td>
                    <td id="age_row1">Plastic</td>
                    <td>2</td>
                    <td>165.6</td>
                    <td>10/01/2019</td>
                    <td>
                        <input type="button" id="edit_button1" value="Edit" class="edit" onclick="edit_row('1');updateChart();">
                        <input type="button" id="save_button1" value="Save" class="save" onclick="save_row('1');updateChart();">
                        <input type="button" value="Delete" class="delete" onclick="delete_row('1');updateChart();">
                    </td>
                </tr>

                <tr id="row2">
                    <td id="name_row2">Milk bottle</td>
                    <td id="country_row2">160</td>
                    <td id="age_row2">Glass</td>
                    <td>2</td>
                    <td>480</td>
                    <td>10/02/2019</td>
                    <td>
                        <input type="button" id="edit_button2" value="Edit" class="edit" onclick="edit_row('2');updateChart();">
                        <input type="button" id="save_button2" value="Save" class="save" onclick="save_row('2');updateChart();">
                        <input type="button" value="Delete" class="delete" onclick="delete_row('2');updateChart();">
                    </td>
                </tr>

                <tr id="row3">
                    <td id="name_row3">Aluminum Tray</td>
                    <td id="country_row3">400</td>
                    <td id="age_row3">Metal</td>
                    <td>1</td>
                    <td>400</td>
                    <td>10/01/2019</td>
                    <td>
                        <input type="button" id="edit_button3" value="Edit" class="edit" onclick="edit_row('3');updateChart();">
                        <input type="button" id="save_button3" value="Save" class="save" onclick="save_row('3');updateChart();">
                        <input type="button" value="Delete" class="delete" onclick="delete_row('3');updateChart();">
                    </td>
                </tr>

                <tr id="row4">
                    <td id="name_row4">Newspaper</td>
                    <td id="country_row4">30</td>
                    <td id="age_row4">Paper</td>
                    <td>3</td>
                    <td>90</td>
                    <td>10/05/2019</td>
                    <td>
                        <input type="button" id="edit_button4" value="Edit" class="edit" onclick="edit_row('4');updateChart();">
                        <input type="button" id="save_button4" value="Save" class="save" onclick="save_row('4');updateChart();">
                        <input type="button" value="Delete" class="delete" onclick="delete_row('4');updateChart();">
                    </td>
                </tr>

                <tr>
                    <td><input type="text" id="new_name"></td>
                    <td><input type="text" id="new_country"></td>
                    <td><input type="text" id="new_age"></td>
                    <td><input type="text" id="new_quantity"></td>
                    <td><input type="text" id="new_emiss"></td>
                    <td><input type="text" id="new_date"></td>
                    <td><input type="button" class="add" onclick="add_row();updateChart();" value="Add Row"></td>
                </tr>

            </table>
        </div>
        <br>
        <br>
        <div>
            <h1>Your Total Emission Breakdown</h1>
            <div style="height: 700px">
                <canvas id="pieChart"></canvas>
            </div>

        </div>

            <div id="bottomBanner">
        <p>University of Texas at Austin (October 2019)   .</p>
    </div>


    <!-- partial -->
    <script src="./script.js"></script>
    <script>

        var table = document.getElementById("data_table")
        var tableLen = table.rows.length
        var data = {
            labels: [],
            population: [],
            area: []
        }

        for (var i = 1; i < tableLen; i++) {
            data.labels.push(table.rows[i].cells[0].innerText)
            data.population.push(table.rows[i].cells[1].innerText)
            data.area.push(table.rows[i].cells[2].innerText)
        }




        var canvasP = document.getElementById("pieChart")
        var ctxP = canvasP.getContext('2d')
        var chart = new Chart(ctxP, {
            type: 'pie',
            data: {
                labels: data.labels,
                datasets: [{
                    data: data.population,
                    backgroundColor: ["#FFA000", "#1976D2", "#64B5F6", "#FFD54F", "#2196F3", "#FFC107", "#0D47A1"],
                    hoverBackgroundColor: ["#B2EBF2", "#FFCCBC", "#4DD0E1", "#FF8A65", "#00BCD4", "#FF5722", "#0097A7"]
                }]
            },
            options: {
                maintainAspectRatio: false,
                legend: {
                    display: true,
                    position: "right"
                }
            }
        });

        function updateChart(){
            chart.data.labels = data.labels;
            chart.data.datasets[0].data = data.population;
            chart.update();
        };



            function edit_row(no) {
            document.getElementById("edit_button" + no).style.display = "none";
            document.getElementById("save_button" + no).style.display = "block";

            var name = document.getElementById("name_row" + no);
            var country = document.getElementById("country_row" + no);
            var age = document.getElementById("age_row" + no);

            var name_data = name.innerHTML;
            var country_data = country.innerHTML;
            var age_data = age.innerHTML;

            name.innerHTML = "<input type='text' id='name_text" + no + "' value='" + name_data + "'>";
            country.innerHTML = "<input type='text' id='country_text" + no + "' value='" + country_data + "'>";
            age.innerHTML = "<input type='text' id='age_text" + no + "' value='" + age_data + "'>";

        
        }

        function save_row(no) {
            var name_val = document.getElementById("name_text" + no).value;
            var country_val = document.getElementById("country_text" + no).value;
            var age_val = document.getElementById("age_text" + no).value;

            document.getElementById("name_row" + no).innerHTML = name_val;
            document.getElementById("country_row" + no).innerHTML = country_val;
            document.getElementById("age_row" + no).innerHTML = age_val;

            document.getElementById("edit_button" + no).style.display = "block";
            document.getElementById("save_button" + no).style.display = "none";

            data.labels[no-1] = name_val;
            data.population[no-1] = country_val;
            data.area[no-1] = age_val;



        }

        function delete_row(no) {
            document.getElementById("row" + no + "").outerHTML = "";
            data.labels.splice(no-1,1);
            data.population.splice(no-1,1);
            data.area.splice(no-1,1);
        }

        function add_row() {
            var new_name = document.getElementById("new_name").value;
            var new_country = document.getElementById("new_country").value;
            var new_age = document.getElementById("new_age").value;
            var new_quantity = document.getElementById("new_quantity").value;
            var new_emiss = document.getElementById("new_emiss").value;
            var new_date = document.getElementById("new_date").value;

            var table = document.getElementById("data_table");
            var table_len = (table.rows.length) - 1;
            var row = table.insertRow(table_len).outerHTML = "<tr id='row" + table_len + "'><td id='name_row" + table_len + "'>" + new_name + "</td><td id='country_row" + table_len + "'>" + new_country + "</td><td id='age_row" + table_len + "'>" + new_age + "</td><td id='quantity_row" + table_len + "'>" + new_quantity + "</td><td id='emiss_row" + table_len + "'>" + new_emiss +  "</td><td id='date_row" + table_len + "'>" + new_date + "</td><td><input type='button' id='edit_button" + table_len + "' value='Edit' class='edit' onclick='edit_row(" + table_len + ")'> <input type='button' id='save_button" + table_len + "' value='Save' class='save' onclick='save_row(" + table_len + ")'> <input type='button' value='Delete' class='delete' onclick='delete_row(" + table_len + ")'></td></tr>";


            data.labels.push(new_name);
            data.population.push(new_country);
            data.area.push(new_age);

            document.getElementById("new_name").value = "";
            document.getElementById("new_country").value = "";
            document.getElementById("new_age").value = "";
        }
</script>


       




    </body>
</html>
